{"version":3,"file":"author-icon.es5.js","sources":["../src/element.js"],"sourcesContent":["class AuthorIconElement extends AuthorBaseElement(HTMLElement) {\n  constructor () {\n    super(`{{TEMPLATE-STRING}}`)\n\n    this.UTIL.defineAttributes({\n      src: {\n        default: null\n      }\n    })\n\n    this.UTIL.defineProperties({\n      xhr: {\n        private: true,\n        readonly: true,\n        default: new XMLHttpRequest()\n      },\n\n      cache: {\n        private: true,\n        readonly: true,\n        default: window.caches.open('author-icons')\n      },\n\n      placeholder: {\n        private: true,\n        readonly: true,\n        default: `<svg width=\"24px\" height=\"24px\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n          <title>Placeholder Icon</title>\n          <desc>Copyright ${new Date().getFullYear()} Author.io</desc>\n          <g>\n            <mask id=\"mask-2\" fill=\"white\">\n              <path d=\"M0,0 L4.8,0 L4.8,24 L0,24 L0,0 Z M7.68,0 L10.56,0 L10.56,24 L7.68,24 L7.68,0 Z M13.44,0 L16.32,0 L16.32,24 L13.44,24 L13.44,0 Z M19.2,0 L24,0 L24,24 L19.2,24 L19.2,0 Z\"></path>\n            </mask>\n            <g mask=\"url(#mask-2)\">\n              <mask id=\"mask-4\" fill=\"white\">\n                <path d=\"M0,0 L24,0 L24,4.8 L0,4.8 L0,0 Z M0,19.2 L24,19.2 L24,24 L0,24 L0,19.2 Z M0,13.44 L24,13.44 L24,16.32 L0,16.32 L0,13.44 Z M0,7.68 L24,7.68 L24,10.56 L0,10.56 L0,7.68 Z\"></path>\n              </mask>\n              <path d=\"M3.84,0 L20.16,0 C22.2807734,-3.89579761e-16 24,1.71922656 24,3.84 L24,20.16 C24,22.2807734 22.2807734,24 20.16,24 L3.84,24 C1.71922656,24 2.5971984e-16,22.2807734 0,20.16 L0,3.84 C-2.5971984e-16,1.71922656 1.71922656,3.89579761e-16 3.84,0 Z M3.84,1.92 C2.77961328,1.92 1.92,2.77961328 1.92,3.84 L1.92,20.16 C1.92,21.2203867 2.77961328,22.08 3.84,22.08 L20.16,22.08 C21.2203867,22.08 22.08,21.2203867 22.08,20.16 L22.08,3.84 C22.08,2.77961328 21.2203867,1.92 20.16,1.92 L3.84,1.92 Z\" fill=\"#545454\" mask=\"url(#mask-4)\"></path>\n            </g>\n          </g>\n        </svg>`\n      }\n    })\n\n    this.UTIL.definePrivateMethods({\n      inject: code => this.innerHTML = code,\n\n      render: async () => {\n        if (!this.src) {\n          return this.PRIVATE.inject(this.PRIVATE.placeholder)\n        }\n\n        let cache = await this.PRIVATE.cache\n        let cachedRequest = await cache.match(this.src)\n\n        if (!cachedRequest) {\n          this.PRIVATE.xhr.open('GET', this.src)\n          return this.PRIVATE.xhr.send()\n        }\n\n        let reader = cachedRequest.body.getReader()\n        reader.read().then(({ value }) => this.PRIVATE.inject(new TextDecoder('utf-8').decode(value)))\n      }\n    })\n\n    this.UTIL.registerListener(this.PRIVATE.xhr, 'load', async evt => {\n      let { responseText, status, statusText } = this.PRIVATE.xhr\n\n      if (status !== 200) {\n        return this.PRIVATE.inject(this.PRIVATE.placeholder)\n      }\n\n      let cache = await this.PRIVATE.cache\n\n      cache.match(this.src).then(async matched => {\n        if (!matched) {\n          await cache.put(this.src, new Response(responseText, {\n            headers: { 'Content-Type': 'image/svg+xml' }\n          }))\n        }\n\n        this.PRIVATE.inject(responseText)\n      })\n    })\n\n    this.UTIL.registerListeners(this, {\n      'attribute.change': evt => {\n        let { attribute, oldValue, newValue } = evt.detail\n\n        if (newValue === oldValue) {\n          return\n        }\n\n        switch (attribute) {\n          case 'src': return this.PRIVATE.render()\n        }\n      }\n    })\n  }\n\n  static get observedAttributes () {\n    return ['src']\n  }\n}\n\ncustomElements.define('author-icon', AuthorIconElement)\n\nexport default AuthorIconElement\n"],"names":["AuthorIconElement","UTIL","defineAttributes","src","default","defineProperties","xhr","private","readonly","XMLHttpRequest","cache","window","caches","open","placeholder","Date","getFullYear","definePrivateMethods","inject","code","innerHTML","render","PRIVATE","match","cachedRequest","send","reader","body","getReader","read","then","value","TextDecoder","decode","registerListener","evt","responseText","status","statusText","matched","put","Response","headers","registerListeners","detail","attribute","oldValue","newValue","AuthorBaseElement","HTMLElement","customElements","define"],"mappings":"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"}